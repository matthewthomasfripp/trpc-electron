"use strict";var g=(t,r,e)=>{if(!r.has(t))throw TypeError("Cannot "+e)};var s=(t,r,e)=>(g(t,r,"read from private field"),e?e.call(t):r.get(t)),h=(t,r,e)=>{if(r.has(t))throw TypeError("Cannot add the same private member more than once");r instanceof WeakSet?r.add(t):r.set(t,e)};var R=(t,r,e)=>(g(t,r,"access private method"),e);Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const O="trpc-electron";function x(t){const r={subscribe(e){let n=null,i=!1,u=!1,c=!1;function o(){if(n===null){c=!0;return}u||(u=!0,typeof n=="function"?n():n&&n.unsubscribe())}return n=t({next(f){var m;i||(m=e.next)==null||m.call(e,f)},error(f){var m;i||(i=!0,(m=e.error)==null||m.call(e,f),o())},complete(){var f;i||(i=!0,(f=e.complete)==null||f.call(e),o())}}),c&&o(),{unsubscribe:o}},pipe(...e){return e.reduce(N,r)}};return r}function N(t,r){return r(t)}function y(t){return!!t&&!Array.isArray(t)&&typeof t=="object"}class z extends Error{}function L(t){if(t instanceof Error)return t;const r=typeof t;if(!(r==="undefined"||r==="function"||t===null)){if(r!=="object")return new Error(String(t));if(y(t)){const e=new z;for(const n in t)e[n]=t[n];return e}}}var T,C,w,p,k,P;typeof window>"u"||"Deno"in window||((C=(T=globalThis.process)==null?void 0:T.env)==null?void 0:C.NODE_ENV)==="test"||(p=(w=globalThis.process)==null?void 0:w.env)!=null&&p.JEST_WORKER_ID||(P=(k=globalThis.process)==null?void 0:k.env)!=null&&P.VITEST_WORKER_ID;function _(t){return t instanceof l||t instanceof Error&&t.name==="TRPCClientError"}function q(t){return y(t)&&y(t.error)&&typeof t.error.code=="number"&&typeof t.error.message=="string"}class l extends Error{static from(r,e={}){const n=r;return _(n)?(e.meta&&(n.meta={...n.meta,...e.meta}),n):q(n)?new l(n.error.message,{...e,result:n}):n instanceof Error?new l(n.message,{...e,cause:L(n)}):new l("Unknown error",{...e,cause:n})}constructor(r,e){var i,u;const n=e==null?void 0:e.cause;super(r,{cause:n}),this.meta=e==null?void 0:e.meta,this.cause=n,this.shape=(i=e==null?void 0:e.result)==null?void 0:i.error,this.data=(u=e==null?void 0:e.result)==null?void 0:u.error.data,this.name="TRPCClientError",Object.setPrototypeOf(this,l.prototype)}}function D(t){const r=t;return r?"input"in r?r:{input:r,output:r}:{input:{serialize:e=>e,deserialize:e=>e},output:{serialize:e=>e,deserialize:e=>e}}}function I(t,r){if("error"in t){const n=r.deserialize(t.error);return{ok:!1,error:{...t,error:n}}}return{ok:!0,result:{...t.result,...(!t.result.type||t.result.type==="data")&&{type:"data",data:r.deserialize(t.result.data)}}}}const M=()=>{const t=globalThis.electronTRPC;if(!t)throw new Error("Could not find `electronTRPC` global. Check that `exposeElectronTRPC` has been called in your preload file.");return t};var a,d,E,b;class S{constructor(){h(this,E);h(this,a,new Map);h(this,d,M());s(this,d).onMessage(r=>{R(this,E,b).call(this,r)})}request(r,e){const{type:n,id:i}=r;return s(this,a).set(i,{type:n,callbacks:e,op:r}),s(this,d).sendMessage({method:"request",operation:r}),()=>{var c;const u=(c=s(this,a).get(i))==null?void 0:c.callbacks;s(this,a).delete(i),u==null||u.complete(),n==="subscription"&&s(this,d).sendMessage({id:i,method:"subscription.stop"})}}}a=new WeakMap,d=new WeakMap,E=new WeakSet,b=function(r){const e=r.id&&s(this,a).get(r.id);e&&(e.callbacks.next(r),"result"in r&&r.result.type==="stopped"&&e.callbacks.complete())};function A(t){return()=>{const r=new S,e=D(t==null?void 0:t.transformer);return({op:n})=>x(i=>{n.input=e.input.serialize(n.input);const u=r.request(n,{error(c){i.error(c),u()},complete(){i.complete()},next(c){const o=I(c,e.output);if(!o.ok){i.error(l.from(o.error));return}i.next({result:o.result}),n.type!=="subscription"&&(u(),i.complete())}});return()=>{u()}})}}exports.ELECTRON_TRPC_CHANNEL=O;exports.ipcLink=A;
